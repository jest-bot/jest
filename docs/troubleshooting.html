<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><title>Troubleshooting · Jest</title><meta name="viewport" content="width=device-width"><meta property="og:title" content="Troubleshooting · Jest"><meta property="og:type" content="website"><meta property="og:url" content="https://facebook.github.io/jest/index.html"><meta property="og:image" content="https://facebook.github.io/jest/img/opengraph.png"><meta property="og:description" content="Uh oh, something went wrong? Use this guide to resolve issues with Jest."><link rel="shortcut icon" href="/jest/img/favicon.png"><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"><link rel="stylesheet" href="/jest/css/jest.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/font-hack/2.020/css/hack.min.css"><script type="text/javascript" src="//use.typekit.net/vqa1hcx.js"></script><script type="text/javascript">try{Typekit.load();}catch(e){}</script></head><body class="sideNavVisible"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/jest/"><img src="/jest/img/jest-outline.svg"><h2>Jest</h2></a><div class="navigationWrapper navigationSlider"><div class="navSlideout"><i class="menuExpand"><span></span><span></span><span></span></i></div><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li><a href="/jest/docs/getting-started.html" class="active">Docs</a></li><li><a href="/jest/support.html" class="">Support</a></li><li><a href="/jest/blog/" class="">Blog</a></li><li><a href="https://github.com/facebook/jest" class="">GitHub</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input id="search_input_react" type="text" placeholder="Search"></li></ul></nav><script>
          var triggers = document.getElementsByClassName('menuExpand');
          var navs = document.getElementsByClassName('navSlideout');
          for (var i=0; i < triggers.length; i++) {
            triggers[i].onclick = function() {
              for (var j=0; j < navs.length; j++) {
                navs[j].classList.toggle('navSlideoutActive');
                navs[j].nextSibling.classList.toggle('slidingNavActive');
              }
            };
          }
        </script></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><i></i></div><h2><a href="/jest/docs/getting-started.html">Docs</a><i>›</i><span>Reference</span></h2></div><div class="navGroups"><div class="navGroup navGroupActive"><h3>Quick Start</h3><ul><li class="navListItem"><a class="navItem" href="/jest/docs/getting-started.html#content">Getting Started</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/tutorial-react.html#content">Tutorial – React</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/tutorial-react-native.html#content">Tutorial – React Native</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/tutorial-async.html#content">Tutorial – Async</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/tutorial-webpack.html#content">Tutorial – webpack</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/tutorial-jquery.html#content">Tutorial – jQuery</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/migration-guide.html#content">Migration Guide</a></li></ul></div><div class="navGroup navGroupActive"><h3>Reference</h3><ul><li class="navListItem"><a class="navItem" href="/jest/docs/api.html#content">API Reference</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/configuration.html#content">Configuration</a></li><li class="navListItem navListItemActive"><a class="navItem navItemActive" href="/jest/docs/troubleshooting.html#content">Troubleshooting</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/mock-functions.html#content">Mock functions</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/manual-mocks.html#content">Manual mocks</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/timer-mocks.html#content">Timer mocks</a></li></ul></div></div></section></div><script>
          var toggler = document.getElementById('navToggler');
          var nav = document.getElementById('docsNav');
          toggler.onclick = function() {
            nav.classList.toggle('docsSliderActive');
          };
        </script></nav></div><div class="container mainContainer documentContainer postContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link" href="https://github.com/facebook/jest/edit/master/docs/Troubleshooting.md" target="_blank">Edit on GitHub</a><h1>Troubleshooting</h1></header><article><div><p>Uh oh, something went wrong? Use this guide to resolve issues with Jest.</p><h3><a class="anchor" name="tests-are-failing-and-you-don-t-know-why"></a>Tests are Failing and You Don&#x27;t Know Why <a class="hash-link" href="#tests-are-failing-and-you-don-t-know-why">#</a></h3><p>Try using the debugging support built into Node.</p><p>Place a <code>debugger;</code> statement in any of your tests, and then, in your project&#x27;s directory, run:</p><p><code>node --debug-brk ./node_modules/.bin/jest -i [any other arguments here]</code></p><p>This will run Jest in a Node process that an external debugger can connect to. Note that the process
will pause until the debugger has connected to it.</p><p>For example, to connect the <a href="https://github.com/node-inspector/node-inspector" target="_blank">Node Inspector</a>
debugger to the paused process, you would first install it (if you don&#x27;t have it installed already):</p><p><code>npm install -g node-inspector</code></p><p>Then simply run it:</p><p><code>node-inspector</code></p><p>This will output a link that you can open in Chrome. After opening that link, the Chrome Developer Tools will be displayed, and a breakpoint will be set at the first line of the Jest CLI script (this is done simply to give you time to open the developer tools and to prevent Jest from executing before you have time to do so). Click the button that looks like a &quot;play&quot; button in the upper right hand side of the screen to continue execution. When Jest executes the test that contains the <code>debugger</code> statement, execution will pause and you can examine the current scope and call stack.</p><p><em>Note: the <code>-i</code> cli option makes sure Jest runs test in the same process rather than spawning processes for individual tests. Normally Jest parallelizes test runs across processes but it is hard to debug many processes at the same time.</em></p><p>More information on Node debugging can be found here: <a href="https://nodejs.org/api/debugger.html">https://nodejs.org/api/debugger.html</a></p><h3><a class="anchor" name="caching-issues"></a>Caching Issues <a class="hash-link" href="#caching-issues">#</a></h3><p>The transform script was changed or babel was updated and the changes aren&#x27;t
being recognized by Jest?</p><p>Retry with <code>--no-cache</code>.</p><p>Explanation: Jest caches transformed module files to speed up test execution.
If you are using your own custom transformer, consider adding a <code>getCacheKey</code>
function to it: <a href="https://github.com/facebook/relay/blob/master/scripts/jest/preprocessor.js#L63-L67" target="_blank">getCacheKey in Relay</a>.</p><h3><a class="anchor" name="unresolved-promises"></a>Unresolved Promises <a class="hash-link" href="#unresolved-promises">#</a></h3><p>If a promise doesn&#x27;t resolve at all, this error might be thrown:</p><pre class="prism language-javascript">
<span class="token operator">-</span> Error<span class="token punctuation">:</span> Timeout <span class="token operator">-</span> Async callback was not invoked within timeout specified by jasmine<span class="token punctuation">.</span>DEFAULT_TIMEOUT_INTERVAL<span class="token punctuation">.</span>`</pre><p>Most commonly this is being caused by conflicting Promise implementations.
Consider replacing the global promise implementation with your own, for example
<code>global.Promise = require.requireActual(&#x27;promise&#x27;);</code> and/or consolidate the
used Promise libraries to a single one.</p><p>If your test is long running, you may want to consider to increase the timeout
specified in <code>jasmine.DEFAULT_TIMEOUT_INTERVAL</code>.</p><pre class="prism language-javascript">
jasmine<span class="token punctuation">.</span>DEFAULT_TIMEOUT_INTERVAL <span class="token operator">=</span> <span class="token number">10000</span><span class="token punctuation">;</span> <span spellcheck="true" class="token comment">// 10 second timeout</span></pre><h3><a class="anchor" name="watchman-issues"></a>Watchman Issues <a class="hash-link" href="#watchman-issues">#</a></h3><p>Try running Jest with <code>--no-watchman</code> or set the <code>watchman</code> configuration option
to <code>false</code>.</p><p>Also see <a href="https://facebook.github.io/watchman/docs/troubleshooting.html" target="_blank">watchman troubleshooting</a>.</p><h3><a class="anchor" name="tests-are-extremely-slow-on-docker-and-or-continuous-integration-server"></a>Tests are Extremely Slow on Docker and/or Continuous Integration server. <a class="hash-link" href="#tests-are-extremely-slow-on-docker-and-or-continuous-integration-server">#</a></h3><p>While Jest is most of the time extremely fast on modern multi-core computers
with fast SSDs, it may be slow on certain setups as our users <a href="https://github.com/facebook/jest/issues/1395" target="_blank">have</a>
<a href="https://github.com/facebook/jest/issues/1524#issuecomment-260246008" target="_blank">discovered</a>.</p><p>Based on the <a href="https://github.com/facebook/jest/issues/1524#issuecomment-262366820" target="_blank">findings</a>,
one way to mitigate this issue and improve the speed by up to 50% is to run tests sequentially.</p><p>In order to do this you can run tests in the same thread using <code>--runInBand</code> or <code>-i</code>:</p><pre class="prism language-javascript">
# Using Jest CLI
jest <span class="token operator">-</span>i

# Using npm test <span class="token punctuation">(</span>e<span class="token punctuation">.</span>g<span class="token punctuation">.</span> <span class="token keyword">with</span> create<span class="token operator">-</span>react<span class="token operator">-</span>app<span class="token punctuation">)</span>
npm test <span class="token operator">--</span> <span class="token operator">-</span>i</pre><h3><a class="anchor" name="i-m-using-npm3-and-my-node-modules-aren-t-properly-loading"></a>I&#x27;m using npm3 and my node_modules aren&#x27;t properly loading. <a class="hash-link" href="#i-m-using-npm3-and-my-node-modules-aren-t-properly-loading">#</a></h3><p>Upgrade <code>jest-cli</code> to <code>0.9.0</code> or above.</p><h3><a class="anchor" name="i-m-using-babel-and-my-unmocked-imports-aren-t-working"></a>I&#x27;m using babel and my unmocked imports aren&#x27;t working? <a class="hash-link" href="#i-m-using-babel-and-my-unmocked-imports-aren-t-working">#</a></h3><p>Upgrade <code>jest-cli</code> to <code>0.9.0</code> or above.</p><p>Explanation:</p><pre class="prism language-javascript">
jest<span class="token punctuation">.</span><span class="token function">dontMock</span><span class="token punctuation">(</span><span class="token string">&#x27;foo&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> foo <span class="token keyword">from</span> <span class="token string">&#x27;./foo&#x27;</span><span class="token punctuation">;</span></pre><p>In ES2015, import statements get hoisted before all other</p><pre class="prism language-javascript">
<span class="token keyword">var</span> foo <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;foo&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
jest<span class="token punctuation">.</span><span class="token function">dontMock</span><span class="token punctuation">(</span><span class="token string">&#x27;foo&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span spellcheck="true" class="token comment">// Oops!</span></pre><p>In Jest 0.9.0, a new API <code>jest.unmock</code> was introduced. Together with a plugin
for babel, this will now work properly when using <code>babel-jest</code>:</p><pre class="prism language-javascript">
jest<span class="token punctuation">.</span><span class="token function">unmock</span><span class="token punctuation">(</span><span class="token string">&#x27;foo&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span spellcheck="true" class="token comment">// Use unmock!</span>

<span class="token keyword">import</span> foo <span class="token keyword">from</span> <span class="token string">&#x27;./foo&#x27;</span><span class="token punctuation">;</span>

<span spellcheck="true" class="token comment">// foo is not mocked!</span></pre><p>See the <a href="/jest/docs/getting-started.html" target="">Getting Started</a> guide on how to
enable babel support.</p><h3><a class="anchor" name="i-upgraded-to-jest-090-and-my-tests-are-now-failing"></a>I upgraded to Jest 0.9.0 and my tests are now failing? <a class="hash-link" href="#i-upgraded-to-jest-090-and-my-tests-are-now-failing">#</a></h3><p>Jest is now using Jasmine 2 by default. It should be easy to upgrade using the
Jasmine <a href="http://jasmine.github.io/2.0/introduction.html" target="_blank">upgrade guide</a>.</p><p>If you would like to continue using Jasmine 1, set the <code>testRunner</code> config
option to <code>jasmine1</code> or pass <code>--testRunner=jasmine1</code> as a command line option.</p><h3><a class="anchor" name="compatibility-issues"></a>Compatibility issues <a class="hash-link" href="#compatibility-issues">#</a></h3><p>Jest takes advantage of new features added to Node 4. We recommend that you
upgrade to the latest stable release of Node. The minimum supported version is
<code>v4.0.0</code>. Versions <code>0.x.x</code> are not supported.</p><h3><a class="anchor" name="still-unresolved"></a>Still unresolved? <a class="hash-link" href="#still-unresolved">#</a></h3><p>See <a href="/jest/support.html" target="">Support</a>.</p></div></article></div><div class="docs-prevnext"><a class="docs-next" href="mock-functions.html#content">Next →</a></div></div></div></div><div class="footerContainer"><div class="wrapper footerWrapper"><div class="footerBlocks"><div class="footerSection fbOpenSourceFooter"><svg class="facebookOSSLogoSvg" viewBox="0 0 1133.9 1133.9" x="0px" y="0px"><g><path class="logoRing outerRing" d="M 498.3 3.7 c 153.6 88.9 307.3 177.7 461.1 266.2 c 7.6 4.4 10.3 9.1 10.3 17.8 c -0.3 179.1 -0.2 358.3 0 537.4 c 0 8.1 -2.4 12.8 -9.7 17.1 c -154.5 88.9 -308.8 178.1 -462.9 267.5 c -9 5.2 -15.5 5.3 -24.6 0.1 c -153.9 -89.2 -307.9 -178 -462.1 -266.8 C 3 838.8 0 833.9 0 825.1 c 0.3 -179.1 0.2 -358.3 0 -537.4 c 0 -8.6 2.6 -13.6 10.2 -18 C 164.4 180.9 318.4 92 472.4 3 C 477 -1.5 494.3 -0.7 498.3 3.7 Z M 48.8 555.3 c 0 79.9 0.2 159.9 -0.2 239.8 c -0.1 10 3 15.6 11.7 20.6 c 137.2 78.8 274.2 157.8 411 237.3 c 9.9 5.7 17 5.7 26.8 0.1 c 137.5 -79.8 275.2 -159.2 412.9 -238.5 c 7.4 -4.3 10.5 -8.9 10.5 -17.8 c -0.3 -160.2 -0.3 -320.5 0 -480.7 c 0 -8.8 -2.8 -13.6 -10.3 -18 C 772.1 218 633.1 137.8 494.2 57.4 c -6.5 -3.8 -11.5 -4.5 -18.5 -0.5 C 336.8 137.4 197.9 217.7 58.8 297.7 c -7.7 4.4 -10.2 9.2 -10.2 17.9 C 48.9 395.5 48.8 475.4 48.8 555.3 Z"></path><path class="logoRing middleRing" d="M 184.4 555.9 c 0 -33.3 -1 -66.7 0.3 -100 c 1.9 -48 24.1 -86 64.7 -110.9 c 54.8 -33.6 110.7 -65.5 167 -96.6 c 45.7 -25.2 92.9 -24.7 138.6 1 c 54.4 30.6 108.7 61.5 162.2 93.7 c 44 26.5 67.3 66.8 68 118.4 c 0.9 63.2 0.9 126.5 0 189.7 c -0.7 50.6 -23.4 90.7 -66.6 116.9 c -55 33.4 -110.8 65.4 -167.1 96.5 c -43.4 24 -89 24.2 -132.3 0.5 c -57.5 -31.3 -114.2 -64 -170 -98.3 c -41 -25.1 -62.9 -63.7 -64.5 -112.2 C 183.5 621.9 184.3 588.9 184.4 555.9 Z M 232.9 556.3 c 0 29.5 0.5 59.1 -0.1 88.6 c -0.8 39.2 16.9 67.1 50.2 86.2 c 51.2 29.4 102.2 59.2 153.4 88.4 c 31.4 17.9 63.6 18.3 95 0.6 c 53.7 -30.3 107.1 -61.2 160.3 -92.5 c 29.7 -17.5 45 -44.5 45.3 -78.8 c 0.6 -61.7 0.5 -123.5 0 -185.2 c -0.3 -34.4 -15.3 -61.5 -44.9 -79 C 637.7 352.6 583 320.8 527.9 290 c -27.5 -15.4 -57.2 -16.1 -84.7 -0.7 c -56.9 31.6 -113.4 64 -169.1 97.6 c -26.4 15.9 -40.7 41.3 -41.1 72.9 C 232.6 491.9 232.9 524.1 232.9 556.3 Z"></path><path class="logoRing innerRing" d="M 484.9 424.4 c 69.8 -2.8 133.2 57.8 132.6 132 C 617 630 558.5 688.7 484.9 689.1 c -75.1 0.4 -132.6 -63.6 -132.7 -132.7 C 352.1 485 413.4 421.5 484.9 424.4 Z M 401.3 556.7 c -3.4 37.2 30.5 83.6 83 84.1 c 46.6 0.4 84.8 -37.6 84.9 -84 c 0.1 -46.6 -37.2 -84.4 -84.2 -84.6 C 432.2 472.1 397.9 518.3 401.3 556.7 Z"></path></g></svg><h2>Facebook Open Source</h2></div><div class="footerSection"><a class="footerLink" href="https://code.facebook.com/projects/" target="_blank">Open Source Projects</a><a class="footerLink" href="https://github.com/facebook/" target="_blank">GitHub</a><a class="footerLink" href="https://twitter.com/fbOpenSource" target="_blank">Twitter</a></div><div class="footerSection rightAlign"><a class="footerLink" href="https://github.com/facebook/jest" target="_blank">Contribute on GitHub</a></div></div></div></div></div><div id="fb-root"></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-44373548-17', 'auto');
            ga('send', 'pageview');

            !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)
            ){js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";
            fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");

            docsearch({
              apiKey: '833906d7486e4059359fa58823c4ef56',
              indexName: 'jest',
              inputSelector: '#search_input_react'
            });
          </script><script async defer src="https://buttons.github.io/buttons.js"></script></body></html>