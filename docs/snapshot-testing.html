<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><title>Snapshot Testing · Jest</title><meta name="viewport" content="width=device-width"><meta property="og:title" content="Snapshot Testing · Jest"><meta property="og:type" content="website"><meta property="og:url" content="https://facebook.github.io/jest/index.html"><meta property="og:image" content="https://facebook.github.io/jest/img/opengraph.png"><meta property="og:description" content="Snapshot tests are a very useful tool whenever you want to make sure your UI does not change unexpectedly."><link rel="alternate" type="application/atom+xml" href="/jest/blog/atom.xml" title="Jest Blog ATOM Feed"><link rel="alternate" type="application/rss+xml" href="/jest/blog/feed.xml" title="Jest Blog RSS Feed"><link rel="shortcut icon" href="/jest/img/favicon.png"><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"><link rel="stylesheet" href="/jest/css/jest.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/font-hack/2.020/css/hack.min.css"><script type="text/javascript" src="//use.typekit.net/vqa1hcx.js"></script><script type="text/javascript">try{Typekit.load();}catch(e){}</script></head><body class="sideNavVisible"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/jest/"><img src="/jest/img/jest-outline.svg"><h2>Jest</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li><a href="/jest/docs/getting-started.html" class="active">Docs</a></li><li><a href="/jest/docs/api.html" class="">API</a></li><li><a href="/jest/help.html" class="">Help</a></li><li><a href="/jest/blog/" class="">Blog</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input id="search_input_react" type="text" placeholder="Search"></li><li><a href="https://github.com/facebook/jest" class="">GitHub</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><i></i></div><h2><a href="/jest/docs/getting-started.html">Docs</a><i>›</i><span>Guides</span></h2></div><div class="navGroups"><div class="navGroup navGroupActive"><h3>Introduction</h3><ul><li class="navListItem"><a class="navItem" href="/jest/docs/getting-started.html#content">Getting Started</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/using-matchers.html#content">Using Matchers</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/asynchronous.html#content">Testing Asynchronous Code</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/setup-teardown.html#content">Setup and Teardown</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/mock-functions.html#content">Mock Functions</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/more-resources.html#content">More Resources</a></li></ul></div><div class="navGroup navGroupActive"><h3>Guides</h3><ul><li class="navListItem navListItemActive"><a class="navItem navItemActive" href="/jest/docs/snapshot-testing.html#content">Snapshot Testing</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/tutorial-react.html#content">Testing React Apps</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/tutorial-react-native.html#content">Testing React Native Apps</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/tutorial-async.html#content">An Async Example</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/timer-mocks.html#content">Timer Mocks</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/manual-mocks.html#content">Manual Mocks</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/webpack.html#content">Using with webpack</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/migration-guide.html#content">Migrating to Jest</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/troubleshooting.html#content">Troubleshooting</a></li></ul></div></div></section></div><script>
          var toggler = document.getElementById('navToggler');
          var nav = document.getElementById('docsNav');
          toggler.onclick = function() {
            nav.classList.toggle('docsSliderActive');
          };
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/facebook/jest/edit/master/docs/SnapshotTesting.md" target="_blank">Edit this Doc</a><h1>Snapshot Testing</h1></header><article><div><p>Snapshot tests are a very useful tool whenever you want to make sure your UI does not change unexpectedly.</p><p>A typical snapshot test case for a mobile app renders a UI component, takes a screenshot, then compares it to a reference image stored alongside the test. The test will fail if the two images do not match: either the change is unexpected, or the screenshot needs to be updated to the new version of the UI component.</p><h2><a class="anchor" name="snapshot-testing-with-jest"></a>Snapshot Testing with Jest <a class="hash-link" href="#snapshot-testing-with-jest">#</a></h2><p>A similar approach can be taken when it comes to testing your React components. Instead of rendering the graphical UI, which would require building the entire app, you can use a test renderer to quickly generate a serializable value for your React tree. Consider this <a href="https://github.com/facebook/jest/blob/master/examples/snapshot/__tests__/Link.react-test.js" target="_blank">example test</a> for a simple <a href="https://github.com/facebook/jest/blob/master/examples/snapshot/Link.react.js" target="_blank">Link component</a>:</p><pre class="prism language-javascript">
<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&#x27;react&#x27;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> Link <span class="token keyword">from</span> <span class="token string">&#x27;../Link.react&#x27;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> renderer <span class="token keyword">from</span> <span class="token string">&#x27;react-test-renderer&#x27;</span><span class="token punctuation">;</span>

<span class="token function">it</span><span class="token punctuation">(</span><span class="token string">&#x27;renders correctly&#x27;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> tree <span class="token operator">=</span> renderer<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>Link page<span class="token operator">=</span><span class="token string">&quot;http://www.facebook.com&quot;</span><span class="token operator">&gt;</span>Facebook<span class="token operator">&lt;</span><span class="token operator">/</span>Link<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toJSON</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>tree<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toMatchSnapshot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><p>The first time this test is run, Jest creates a <a href="https://github.com/facebook/jest/blob/master/examples/snapshot/__tests__/__snapshots__/Link.react-test.js.snap" target="_blank">snapshot file</a> that looks like this:</p><pre class="prism language-javascript">
exports<span class="token punctuation">[</span><span class="token template-string"><span class="token string">`Link renders correctly 1`</span></span><span class="token punctuation">]</span> <span class="token operator">=</span> `
<span class="token operator">&lt;</span>a
  className<span class="token operator">=</span><span class="token string">&quot;normal&quot;</span>
  href<span class="token operator">=</span><span class="token string">&quot;http://www.facebook.com&quot;</span>
  onMouseEnter<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">[</span>Function bound _onMouseEnter<span class="token punctuation">]</span><span class="token punctuation">}</span>
  onMouseLeave<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">[</span>Function bound _onMouseLeave<span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
  Facebook
<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span>
`<span class="token punctuation">;</span></pre><p>The snapshot artifact should be committed alongside code changes. Jest uses <a href="https://github.com/thejameskyle/pretty-format" target="_blank">pretty-format</a> to make snapshots human-readable during code review. On subsequent test runs Jest will simply compare the rendered output with the previous snapshot. If they match, the test will pass. If they don&#x27;t match, either the test runner found a bug in your code that should be fixed, or the implementation has changed and the snapshot needs to be updated.</p><p>More information on how snapshot testing works and why we built it can be found on the <a href="https://facebook.github.io/jest/blog/2016/07/27/jest-14.html" target="_blank">release blog post</a>. We recommend reading <a href="http://benmccormick.org/2016/09/19/testing-with-jest-snapshots-first-impressions/" target="_blank">this blog post</a> to get a good sense of when you should use snapshot testing. We also recommend watching this <a href="https://egghead.io/lessons/javascript-use-jest-s-snapshot-testing-feature?pl=testing-javascript-with-jest-a36c4074" target="_blank">this egghead video</a> on Snapshot Testing with Jest.</p><h3><a class="anchor" name="updating-snapshots"></a>Updating Snapshots <a class="hash-link" href="#updating-snapshots">#</a></h3><p>It&#x27;s straightforward to spot when a snapshot test fails after a bug has been introduced. When that happens, go ahead and fix the issue and make sure your snapshot tests are passing again. Now, let&#x27;s talk about the case when a snapshot test is failing due to an intentional implementation change.</p><p>One such situation can arise if we intentionally change the address the Link component in our example is pointing to.</p><pre class="prism language-javascript">
<span spellcheck="true" class="token comment">// Updated test case with a Link to a different address</span>
<span class="token function">it</span><span class="token punctuation">(</span><span class="token string">&#x27;renders correctly&#x27;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> tree <span class="token operator">=</span> renderer<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>Link page<span class="token operator">=</span><span class="token string">&quot;https://facebook.github.io/jest/&quot;</span><span class="token operator">&gt;</span>Jest<span class="token operator">&lt;</span><span class="token operator">/</span>Link<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toJSON</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>tree<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toMatchSnapshot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><p>In that case, Jest will print this output:</p><p><img src="/jest/img/content/failedSnapshotTest.png" alt=""></p><p>Since we just updated our component to point to a different address, it&#x27;s reasonable to expect changes in the snapshot for this component. Our snapshot test case is failing because the snapshot for our updated component no longer matches the snapshot artifact for this test case.</p><p>To resolve this, we will need to update our snapshot artifacts. You can run Jest with a flag that will tell it to re-generate snapshots:</p><pre class="prism language-javascript">
jest <span class="token operator">--</span>updateSnapshot</pre><p>Go ahead and accept the changes by running the above command. You may also use the equivalent single-character <code>-u</code> flag to re-generate snapshots if you prefer. This will re-generate snapshot artifacts for all failing snapshot tests. If we had any additional failing snapshot tests due to an unintentional bug, we would need to fix the bug before re-generating snapshots to avoid recording snapshots of the buggy behavior.</p><p>If you&#x27;d like to limit which snapshot test cases get re-generated, you can pass an additional <code>--testNamePattern</code> flag to re-record snapshots only for those tests that match the pattern.</p><p>You can try out this functionality by cloning the <a href="https://github.com/facebook/jest/tree/master/examples/snapshot" target="_blank">snapshot example</a>, modifying the <code>Link</code> component, and running Jest.</p><h3><a class="anchor" name="tests-should-be-deterministic"></a>Tests Should Be Deterministic <a class="hash-link" href="#tests-should-be-deterministic">#</a></h3><p>Your tests should be deterministic. That is, running the same tests multiple times on a component that has not changed should produce the same results every time. You&#x27;re responsible for making sure your generated snapshots do not include platform specific or other non-deterministic data.</p><p>For example, if you have a <a href="https://github.com/facebook/jest/blob/master/examples/snapshot/Clock.react.js" target="_blank">Clock</a> component that uses <code>Date.now()</code>, the snapshot generated from this component will be different every time the test case is run. In this case we can <a href="/jest/docs/mock-functions.html" target="">mock the Date.now() method</a> to return a consistent value every time the test is run:</p><pre class="prism language-javascript">
Date<span class="token punctuation">.</span>now <span class="token operator">=</span> jest<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">1482363367071</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><p>Now, every time the snapshot test case runs, <code>Date.now()</code> will return <code>1482363367071</code> consistently. This will result in the same snapshot being generated for this component regardless of when the test is run.</p><h2><a class="anchor" name="react-react-native-and-snapshot-testing"></a>React, React Native and Snapshot Testing <a class="hash-link" href="#react-react-native-and-snapshot-testing">#</a></h2><p>As you&#x27;ve learned, snapshot testing was built to make it easier to write tests for React and React Native. Check out the <a href="/jest/docs/tutorial-react.html" target="">React tutorial</a> and the <a href="/jest/docs/tutorial-react-native.html" target="">React Native tutorial</a> to get started with snapshot testing on your React or React Native application.</p><h2><a class="anchor" name="additional-uses"></a>Additional Uses <a class="hash-link" href="#additional-uses">#</a></h2><p>Snapshots can capture any serializable value. Common examples are <a href="https://github.com/facebook/jest/blob/master/integration_tests/__tests__/console-test.js" target="_blank">snapshotting CLI output</a> or API responses.</p></div></article></div><div class="docs-prevnext"><a class="docs-next button" href="tutorial-react.html#content">Continue Reading →</a></div></div></div></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/jest" class="nav-home"><img src="/jest/img/jest-outline.svg" alt="Jest" width="66" height="58"></a><div><h5>Docs</h5><a href="/jest/docs/getting-started.html">Getting Started</a><a href="/jest/docs/snapshot-testing.html">Guides</a><a href="/jest/docs/api.html">API Reference</a></div><div><h5>Community</h5><a href="/jest/users.html">User Showcase</a><a href="http://stackoverflow.com/questions/tagged/jestjs" target="_blank">Stack Overflow</a><a href="https://discordapp.com/channels/102860784329052160/103622435865104384">Jest Chat</a><a href="https://twitter.com/fbjest" target="_blank">Twitter</a></div><div><h5>More</h5><a href="/jest/blog">Blog</a><a href="https://github.com/facebook/jest">GitHub</a><a class="github-button" href="https://github.com/facebook/jest" data-icon="octicon-star" data-count-href="/facebook/jest/stargazers" data-count-api="/repos/facebook/jest#stargazers_count" data-count-aria-label="# stargazers on GitHub" aria-label="Star facebook/jest on GitHub">Star</a></div></section><a href="https://code.facebook.com/projects/" target="_blank" class="fbOpenSource"><img src="/jest/img/oss_logo.png" alt="Facebook Open Source" width="170" height="45"></a><section class="copyright">Copyright © 2017 Facebook Inc.</section></footer></div><div id="fb-root"></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-44373548-17', 'auto');
            ga('send', 'pageview');

            !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)
            ){js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";
            fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");

            docsearch({
              apiKey: '833906d7486e4059359fa58823c4ef56',
              indexName: 'jest',
              inputSelector: '#search_input_react'
            });
          </script><script async defer src="https://buttons.github.io/buttons.js"></script></body></html>